<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"> 
<html>
<head>
<title>Chart Demo</title>
<script type="text/javascript" src="js/chartx.js"></script>
<script type="text/javascript" src="js/prices.js"></script>
<script type="text/javascript">
function onLoad() {
	var c1 = new ChartX("test1", {
		"width": 1000,
		"height": 160,
		"bufferfactor": 3,
		"title": "WTI",
		"legend": true,
		"container": "charts",
		"bgcolor": "black",
		"linewidth": 1,
		"grid": {
			"color": "#666666",
			"hsegments": 200,
			"vsegments": 20,
			"linewidth": .5
		},
		"series": [
			{
				"name": "WTI",
				"color": "#cc3300",
				"type": "line",
				"yscale": 40,
				"cross": 20
			}
		]
	});
	var c2 = new ChartX("test2", {
		"width": 1000,
		"height": 160,
		"bufferfactor": 3,
		"title": "Brent",
		"legend": true,
		"container": "charts",
		"bgcolor": "black",
		"linewidth": 1,
		"grid": {
			"color": "#666666",
			"hsegments": 200,
			"vsegments": 20,
			"linewidth": .5
		},
		"series": [
			{
				"name": "Brent",
				"color": "#339900",
				"type": "line",
				"yscale": 40,
				"cross": 20
			}
		]
	});
	var c3 = new ChartX("test3", {
		"width": 400,
		"height": 100,
		"bufferfactor": 3,
		"title": "Spread",
		"legend": true,
		"container": "charts",
		"bgcolor": "black",
		"linewidth": 1,
		"grid": {
			"color": "#666666",
			"hsegments": 50,
			"vsegments": 20,
			"linewidth": .5
		},
		"series": [
			{
				"name": "Spread",
				"color": "#cc66cc",
				"type": "line",
				"yscale": 30,
				"cross": 15
			}
		]
	});
	var idx = 0;
	var prev = null;
	var lastspread = 0;
	setInterval(function() {
		var price = prices[idx++];
		if(prev) {
			var wti = ((price[2] * 100) - (prev[2] * 100));
			var brent = ((price[3] * 100) - (prev[3] * 100));
			c1.draw({
				WTI: wti
			});
			c2.draw({
				Brent: brent
			});
			c3.draw({
				Spread: Math.abs(((price[2]*100) - (price[3]*100))) - lastspread,
			});
		}
		prev = price;
		lastspread = Math.abs((price[2] * 100) - (price[3] * 100));
		if(idx == prices.length) idx = 0;
	}, 100);
/*
	prices.forEach(function(price) {
		var wti = (price[2] * 100) - 11250;
		var brent = (price[3] * 100) - 8700;
		c1.draw({
			Spread: wti - brent + 50,
			WTI: wti,
			Brent: brent
		});
	});
*/
}
</script>
<style>
body, textarea, input, p, div {
  font-family: "Lucida Console", "DejaVu Sans Mono", "Bitstream Vera Sans Mono", Consolas, "Andale Mono", "Courier New";
}

body {
  background-color: #f5f5f5;
  font-size: 8pt;
  margin: 0;
  padding: 4px;
}

div.chartc {
	padding: 4px;
	border: 1px solid silver;
	margin: 2px;
	float: left;
}

canvas.chart {
	border: 1px solid gray; 
	margin: 2px;
}
</style>
</head>
<body onload="onLoad()">
<div id="charts"></div>
</body>
</html>
